<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Hutton’s razor</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/msp-strath/Mary@latest/src/data-dir/shonkier.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script src="https://cdn.jsdelivr.net/gh/msp-strath/Mary@latest/src/data-dir/Shonkier.js"></script>
  <script>
  var globalEnv = {};
  globalEnv["atom"] = {};
  globalEnv["atom"]["."] = VFun(null,{},[],[Clause([],App(Atom("choice"),[Var(GlobalVar(false,"."),"number"),Fun([],[Clause([],App(Var(GlobalVar(false,"."),"parens"),[Var(GlobalVar(false,"."),"plus")]))])]))]);
  globalEnv["chain"] = {};
  globalEnv["chain"]["."] = VFun(null,{},[],[Clause([Value("i"),Value("c"),Value("a")],App(Var(GlobalVar(false,"."),"reduce"),[App(Var(LocalVar(),"i"),[]),App(Var(GlobalVar(false,"."),"many"),[Fun([],[Clause([],Cell(App(Var(LocalVar(),"c"),[]),Cell(App(Var(LocalVar(),"a"),[]),Nil())))])])]))]);
  globalEnv["convert"] = {};
  globalEnv["convert"]["."] = VFun(null,{},[],[Clause([Value(Nil())],Lit(LitNum(0,1))),Clause([Value(Cell("d","ds"))],App(Var(GlobalVar(false,"."),"primInfixPlus"),[Var(LocalVar(),"d"),App(Var(GlobalVar(false,"."),"primInfixTimes"),[Lit(LitNum(10,1)),App(Var(GlobalVar(false,"."),"convert"),[Var(LocalVar(),"ds")])])]))]);
  globalEnv["digit"] = {};
  globalEnv["digit"]["."] = VFun(null,{},[],[Clause([],App(Var(GlobalVar(false,"."),"satisfy"),[Var(GlobalVar(false,"."),"isDigit")]))]);
  globalEnv["hutton"] = {};
  globalEnv["hutton"]["."] = VFun(null,{},[],[Clause([],App(Var(GlobalVar(false,"."),"plus"),[]))]);
  globalEnv["is"] = {};
  globalEnv["is"]["."] = VFun(null,{},[],[Clause([Value("c")],App(Var(GlobalVar(false,"."),"satisfy"),[Fun([],[Clause([Value("d")],App(Var(GlobalVar(false,"."),"primInfixEquals"),[Var(LocalVar(),"c"),Var(LocalVar(),"d")]))])]))]);
  globalEnv["isDigit"] = {};
  globalEnv["isDigit"]["."] = VFun(null,{},[],[Clause([Value(Stringy("0"))],Lit(LitNum(0,1))),Clause([Value(Stringy("1"))],Lit(LitNum(1,1))),Clause([Value(Stringy("2"))],Lit(LitNum(2,1))),Clause([Value(Stringy("3"))],Lit(LitNum(3,1))),Clause([Value(Stringy("4"))],Lit(LitNum(4,1))),Clause([Value(Stringy("5"))],Lit(LitNum(5,1))),Clause([Value(Stringy("6"))],Lit(LitNum(6,1))),Clause([Value(Stringy("7"))],Lit(LitNum(7,1))),Clause([Value(Stringy("8"))],Lit(LitNum(8,1))),Clause([Value(Stringy("9"))],Lit(LitNum(9,1)))]);
  globalEnv["main"] = {};
  globalEnv["main"]["."] = VFun(null,{},[],[Clause([],Cell(Atom("Plain"),Cell(App(Var(GlobalVar(false,"."),"printTree"),[App(Var(GlobalVar(false,"."),"runParser"),[Stringy("31*(13+7*2)+24*42"),App(Var(GlobalVar(false,"."),"hutton"),[])])]),Nil())))]);
  globalEnv["many"] = {};
  globalEnv["many"]["."] = VFun(null,{},[],[Clause([Value("p")],App(Atom("choice"),[Fun([],[Clause([],App(Var(GlobalVar(false,"."),"some"),[Var(LocalVar(),"p")]))]),Fun([],[Clause([],Nil())])]))]);
  globalEnv["mult"] = {};
  globalEnv["mult"]["."] = VFun(null,{},[],[Clause([],App(Var(GlobalVar(false,"."),"chain"),[Var(GlobalVar(false,"."),"atom"),Fun([],[Clause([],Semi(App(Var(GlobalVar(false,"."),"is"),[Stringy("*")]),Atom("Mult")))]),Var(GlobalVar(false,"."),"atom")]))]);
  globalEnv["number"] = {};
  globalEnv["number"]["."] = VFun(null,{},[],[Clause([],App(Var(GlobalVar(false,"."),"convert"),[App(Var(GlobalVar(false,"."),"reverse"),[App(Var(GlobalVar(false,"."),"some"),[Var(GlobalVar(false,"."),"digit")])])]))]);
  globalEnv["parens"] = {};
  globalEnv["parens"]["."] = VFun(null,{},[],[Clause([Value("p")],App(Fun([],[Clause([Value(Cell(Lit(true),Cell("v",Cell(Lit(true),Nil()))))],Var(LocalVar(),"v"))]),[Cell(App(Var(GlobalVar(false,"."),"is"),[Stringy("(")]),Cell(App(Var(LocalVar(),"p"),[]),Cell(App(Var(GlobalVar(false,"."),"is"),[Stringy(")")]),Nil())))]))]);
  globalEnv["plus"] = {};
  globalEnv["plus"]["."] = VFun(null,{},[],[Clause([],App(Var(GlobalVar(false,"."),"chain"),[Var(GlobalVar(false,"."),"mult"),Fun([],[Clause([],Semi(App(Var(GlobalVar(false,"."),"is"),[Stringy("+")]),Atom("Plus")))]),Var(GlobalVar(false,"."),"mult")]))]);
  globalEnv["primInfixAnd"] = {};
  globalEnv["primInfixAnd"]["."] = VPrim("primInfixAnd",[]);
  globalEnv["primInfixEquals"] = {};
  globalEnv["primInfixEquals"]["."] = VPrim("primInfixEquals",[]);
  globalEnv["primInfixGreater"] = {};
  globalEnv["primInfixGreater"]["."] = VPrim("primInfixGreater",[]);
  globalEnv["primInfixGreaterEq"] = {};
  globalEnv["primInfixGreaterEq"]["."] = VPrim("primInfixGreaterEq",[]);
  globalEnv["primInfixLess"] = {};
  globalEnv["primInfixLess"]["."] = VPrim("primInfixLess",[]);
  globalEnv["primInfixLessEq"] = {};
  globalEnv["primInfixLessEq"]["."] = VPrim("primInfixLessEq",[]);
  globalEnv["primInfixMinus"] = {};
  globalEnv["primInfixMinus"]["."] = VPrim("primInfixMinus",[]);
  globalEnv["primInfixOr"] = {};
  globalEnv["primInfixOr"]["."] = VPrim("primInfixOr",[]);
  globalEnv["primInfixOver"] = {};
  globalEnv["primInfixOver"]["."] = VPrim("primInfixOver",[]);
  globalEnv["primInfixPlus"] = {};
  globalEnv["primInfixPlus"]["."] = VPrim("primInfixPlus",[]);
  globalEnv["primInfixTimes"] = {};
  globalEnv["primInfixTimes"]["."] = VPrim("primInfixTimes",[]);
  globalEnv["primInfixUnequal"] = {};
  globalEnv["primInfixUnequal"]["."] = VPrim("primInfixUnequal",[]);
  globalEnv["primNumToString"] = {};
  globalEnv["primNumToString"]["."] = VPrim("primNumToString",[]);
  globalEnv["primPrefixNot"] = {};
  globalEnv["primPrefixNot"]["."] = VPrim("primPrefixNot",[]);
  globalEnv["primStringConcat"] = {};
  globalEnv["primStringConcat"]["."] = VPrim("primStringConcat",[]);
  globalEnv["primStringToNum"] = {};
  globalEnv["primStringToNum"]["."] = VPrim("primStringToNum",[]);
  globalEnv["printTree"] = {};
  globalEnv["printTree"]["."] = VFun(null,{},[],[Clause([Value(Cell(Atom("Plus"),Cell("s",Cell("t",Nil()))))],Stringy(Strunk("['Plus ",App(Var(GlobalVar(false,"."),"printTree"),[Var(LocalVar(),"s")]),Strunk(" ",App(Var(GlobalVar(false,"."),"printTree"),[Var(LocalVar(),"t")]),"]")))),Clause([Value(Cell(Atom("Mult"),Cell("s",Cell("t",Nil()))))],Stringy(Strunk("['Mult ",App(Var(GlobalVar(false,"."),"printTree"),[Var(LocalVar(),"s")]),Strunk(" ",App(Var(GlobalVar(false,"."),"printTree"),[Var(LocalVar(),"t")]),"]")))),Clause([Value("n")],App(Var(GlobalVar(false,"."),"primNumToString"),[Var(LocalVar(),"n")]))]);
  globalEnv["reduce"] = {};
  globalEnv["reduce"]["."] = VFun(null,{},[],[Clause([Value("v"),Value(Nil())],Var(LocalVar(),"v")),Clause([Value("v"),Value(Cell(Cell("c",Cell("a",Nil())),"xs"))],Cell(Var(LocalVar(),"c"),Cell(Var(LocalVar(),"v"),Cell(App(Var(GlobalVar(false,"."),"reduce"),[Var(LocalVar(),"a"),Var(LocalVar(),"xs")]),Nil()))))]);
  globalEnv["reverse"] = {};
  globalEnv["reverse"]["."] = VFun(null,{},[],[Clause([Value("xs")],App(Var(GlobalVar(false,"."),"reverseAcc"),[Nil(),Var(LocalVar(),"xs")]))]);
  globalEnv["reverseAcc"] = {};
  globalEnv["reverseAcc"]["."] = VFun(null,{},[],[Clause([Value("acc"),Value(Nil())],Var(LocalVar(),"acc")),Clause([Value("acc"),Value(Cell("x","xs"))],App(Var(GlobalVar(false,"."),"reverseAcc"),[Cell(Var(LocalVar(),"x"),Var(LocalVar(),"acc")),Var(LocalVar(),"xs")]))]);
  globalEnv["runParser"] = {};
  globalEnv["runParser"]["."] = VFun(null,{},[[],["getChar","choice"]],[Clause([Value(Stringy(Strunk("",Cell("c","cs"),""))),Request("getChar",[],"k")],App(Var(GlobalVar(false,"."),"runParser"),[Var(LocalVar(),"cs"),App(Var(LocalVar(),"k"),[Var(LocalVar(),"c")])])),Clause([Value(Stringy("")),Request("getChar",[],"k")],App(Var(LocalVar(),"k"),[App(Atom("abort"),[])])),Clause([Value("cs"),Request("choice",["a","b"],"k")],Prio(App(Var(GlobalVar(false,"."),"runParser"),[Var(LocalVar(),"cs"),App(Var(LocalVar(),"k"),[App(Var(LocalVar(),"a"),[])])]),App(Var(GlobalVar(false,"."),"runParser"),[Var(LocalVar(),"cs"),App(Var(LocalVar(),"k"),[App(Var(LocalVar(),"b"),[])])]))),Clause([Value(Stringy("")),Value("v")],Var(LocalVar(),"v")),Clause([Value("cs"),Value("v")],Cell(Var(LocalVar(),"v"),Cell(Var(LocalVar(),"cs"),Nil())))]);
  globalEnv["satisfy"] = {};
  globalEnv["satisfy"]["."] = VFun(null,{},[],[Clause([Value("p")],App(Var(LocalVar(),"p"),[App(Atom("getChar"),[])]))]);
  globalEnv["some"] = {};
  globalEnv["some"]["."] = VFun(null,{},[],[Clause([Value("p")],Cell(App(Var(LocalVar(),"p"),[]),App(Var(GlobalVar(false,"."),"many"),[Var(LocalVar(),"p")])))]);
  </script>
  <script>
  var inputs = {};
  inputs["GET_page"] = "/examples/hutton.mary";
  inputs["user"] = "testymctestyface";
  </script>

</head>
<body>
<form method="post">
<h1 id="huttons-razor">Hutton’s razor</h1>
<p>The following AST</p>
['Plus ['Mult 31 ['Plus 13 ['Mult 7 2]]] ['Mult 24 42]]
<p>is obtained by running the following program</p>
<div class="shonkier-pretty">
<span class="shonkier-function">main</span>() <span class="shonkier-operator">-&gt;</span> [<span class="shonkier-atom">'Plain</span> printTree(runParser(<span class="shonkier-string">"31*(13+7*2)+24*42"</span>, hutton()))]
</div>
<p>using the following auxiliary definitions.</p>
<div class="shonkier-pretty">
<span class="shonkier-function">runParser</span>(, getChar choice)<br />
<span class="shonkier-function">runParser</span>(<span class="shonkier-string">"<span class="shonkier-splice">`[c|cs]`</span>"</span>, {<span class="shonkier-atom">'getChar</span>() <span class="shonkier-operator">-&gt;</span> k}) <span class="shonkier-operator">-&gt;</span> runParser(cs, k(c))<br />
<span class="shonkier-function">runParser</span>(<span class="shonkier-string">""</span>, {<span class="shonkier-atom">'getChar</span>() <span class="shonkier-operator">-&gt;</span> k}) <span class="shonkier-operator">-&gt;</span> k(<span class="shonkier-atom">'abort</span>())<br />
<span class="shonkier-function">runParser</span>(cs, {<span class="shonkier-atom">'choice</span>(a, b) <span class="shonkier-operator">-&gt;</span> k}) <span class="shonkier-operator">-&gt;</span> runParser(cs, k(a())) <span class="shonkier-operator">?&gt;</span> runParser( cs<br />
, k(b()) )<br />
<span class="shonkier-function">runParser</span>(<span class="shonkier-string">""</span>, v) <span class="shonkier-operator">-&gt;</span> v<br />
<span class="shonkier-function">runParser</span>(cs, v) <span class="shonkier-operator">-&gt;</span> [v cs]<br />
<br />
<span class="shonkier-function">satisfy</span>(p) <span class="shonkier-operator">-&gt;</span> p(<span class="shonkier-atom">'getChar</span>())<br />
<br />
<span class="shonkier-function">is</span>(c) <span class="shonkier-operator">-&gt;</span> satisfy({d <span class="shonkier-operator">-&gt;</span> c <span class="shonkier-operator">==</span> d})<br />
<br />
<span class="shonkier-function">some</span>(p) <span class="shonkier-operator">-&gt;</span> [p()|many(p)]<br />
<br />
<span class="shonkier-function">many</span>(p) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-atom">'choice</span>({some(p)}, {[]})<br />
<br />
<span class="shonkier-function">isDigit</span>(<span class="shonkier-string">"0"</span>) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-numeric">0</span><br />
<span class="shonkier-function">isDigit</span>(<span class="shonkier-string">"1"</span>) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-numeric">1</span><br />
<span class="shonkier-function">isDigit</span>(<span class="shonkier-string">"2"</span>) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-numeric">2</span><br />
<span class="shonkier-function">isDigit</span>(<span class="shonkier-string">"3"</span>) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-numeric">3</span><br />
<span class="shonkier-function">isDigit</span>(<span class="shonkier-string">"4"</span>) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-numeric">4</span><br />
<span class="shonkier-function">isDigit</span>(<span class="shonkier-string">"5"</span>) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-numeric">5</span><br />
<span class="shonkier-function">isDigit</span>(<span class="shonkier-string">"6"</span>) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-numeric">6</span><br />
<span class="shonkier-function">isDigit</span>(<span class="shonkier-string">"7"</span>) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-numeric">7</span><br />
<span class="shonkier-function">isDigit</span>(<span class="shonkier-string">"8"</span>) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-numeric">8</span><br />
<span class="shonkier-function">isDigit</span>(<span class="shonkier-string">"9"</span>) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-numeric">9</span><br />
<br />
<span class="shonkier-function">digit</span>() <span class="shonkier-operator">-&gt;</span> satisfy(isDigit)<br />
<br />
<span class="shonkier-function">number</span>() <span class="shonkier-operator">-&gt;</span> convert(reverse(some(digit)))<br />
<br />
<span class="shonkier-function">reverse</span>(xs) <span class="shonkier-operator">-&gt;</span> reverseAcc([], xs)<br />
<br />
<span class="shonkier-function">reverseAcc</span>(acc, []) <span class="shonkier-operator">-&gt;</span> acc<br />
<span class="shonkier-function">reverseAcc</span>(acc, [x|xs]) <span class="shonkier-operator">-&gt;</span> reverseAcc([x|acc], xs)<br />
<br />
<span class="shonkier-function">convert</span>([]) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-numeric">0</span><br />
<span class="shonkier-function">convert</span>([d|ds]) <span class="shonkier-operator">-&gt;</span> d <span class="shonkier-operator">+</span> <span class="shonkier-numeric">10</span> <span class="shonkier-operator">*</span> convert(ds)<br />
<br />
<span class="shonkier-function">parens</span>(p) <span class="shonkier-operator">-&gt;</span> {[<span class="shonkier-boolean">'1</span> v <span class="shonkier-boolean">'1</span>] <span class="shonkier-operator">-&gt;</span> v}([is(<span class="shonkier-string">"("</span>) p() is(<span class="shonkier-string">")"</span>)])<br />
<br />
<span class="shonkier-function">chain</span>(i, c, a) <span class="shonkier-operator">-&gt;</span> reduce(i(), many({[c() a()]}))<br />
<br />
<span class="shonkier-function">reduce</span>(v, []) <span class="shonkier-operator">-&gt;</span> v<br />
<span class="shonkier-function">reduce</span>(v, [[c a]|xs]) <span class="shonkier-operator">-&gt;</span> [c v reduce(a, xs)]<br />
<br />
<span class="shonkier-function">atom</span>() <span class="shonkier-operator">-&gt;</span> <span class="shonkier-atom">'choice</span>(number, {parens(plus)})<br />
<br />
<span class="shonkier-function">mult</span>() <span class="shonkier-operator">-&gt;</span> chain(atom, {is(<span class="shonkier-string">"*"</span>)<span class="shonkier-operator">;</span> <span class="shonkier-atom">'Mult</span>}, atom)<br />
<br />
<span class="shonkier-function">plus</span>() <span class="shonkier-operator">-&gt;</span> chain(mult, {is(<span class="shonkier-string">"+"</span>)<span class="shonkier-operator">;</span> <span class="shonkier-atom">'Plus</span>}, mult)<br />
<br />
<span class="shonkier-function">hutton</span>() <span class="shonkier-operator">-&gt;</span> plus()<br />
<br />
<span class="shonkier-function">printTree</span>([<span class="shonkier-atom">'Plus</span> s t]) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-string">"['Plus <span class="shonkier-splice">`printTree(s)`</span> <span class="shonkier-splice">`printTree(t)`</span>]"</span><br />
<span class="shonkier-function">printTree</span>([<span class="shonkier-atom">'Mult</span> s t]) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-string">"['Mult <span class="shonkier-splice">`printTree(s)`</span> <span class="shonkier-splice">`printTree(t)`</span>]"</span><br />
<span class="shonkier-function">printTree</span>(n) <span class="shonkier-operator">-&gt;</span> <span class="shonkier-primitive">primNumToString</span>(n)
</div>
</form>
</body>
</html>
